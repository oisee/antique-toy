# Приложение G: Справочник регистров AY-3-8910 / TurboSound / Triple AY

> *«Четырнадцать регистров. Три канала прямоугольного тона. Один генератор шума. Один генератор огибающей. Это всё, что у тебя есть.»*
> -- Глава 11

---

Это приложение -- полный справочник на уровне регистров для программируемого звукового генератора AY-3-8910, используемого в ZX Spectrum 128K, клонах с TurboSound (Pentagon, Scorpion) и конфигурации тройного AY на ZX Spectrum Next. Глава 11 покрывает музыкальные техники; это приложение -- даташит, который ты держишь открытым при написании кода.

Все шестнадцатеричные значения используют нотацию `$FF`. Двоичные -- `%10101010`. Частота тактирования предполагается стандартной PAL Spectrum 128K -- 1,7734 МГц, если не указано иное.

---

## Порты ввода/вывода на ZX Spectrum 128K

| Порт | Направление | Функция |
|------|-----------|----------|
| **$FFFD** | Запись | Выбор активного регистра (0-15) |
| **$FFFD** | Чтение | Чтение значения текущего выбранного регистра |
| **$BFFD** | Запись | Запись данных в выбранный регистр |

### Последовательность записи

Каждая запись в регистр AY -- двухшаговая операция: выбрать регистр, затем записать значение.

```z80
; Write value E to AY register A
; Clobbers: BC
ay_write:
    ld   bc, $FFFD
    out  (c), a       ; 12T  select register
    ld   b, $BF       ; 7T   BC = $BFFD (C stays $FD)
    out  (c), e       ; 12T  write data
    ret               ;      total: 31T + call overhead
```

Трюк: между двумя инструкциями `OUT` меняется только старший байт BC. Младший байт `$FD` остаётся в C. Это экономит 3 байта и 10 тактов (T-state) по сравнению с загрузкой полного 16-битного значения дважды.

### Чтение регистра

```z80
; Read AY register A into A
; Clobbers: BC
ay_read:
    ld   bc, $FFFD
    out  (c), a       ; select register
    in   a, (c)       ; read value
    ret
```

Чтение полезно для сохранения состояния микшера (R7) при изменении флагов включения отдельных каналов.

### Массовая запись регистров

Для музыкальных движков, обновляющих все 14 регистров за кадр, развёрнутый цикл -- самый быстрый:

```z80
; Write all 14 AY registers from a buffer
; HL = pointer to 14-byte register buffer (R0-R13)
ay_flush:
    ld   de, $BFFD         ; D = $BF, E = $FD
    ld   c, e              ; C = $FD (shared low byte)
    ld   b, $FF             ; BC = $FFFD (register select port)
    xor  a                  ; start at R0
.loop:
    out  (c), a             ; select register A
    ld   b, d               ; BC = $BFFD
    outi                    ; write (HL) to port, inc HL, dec B
    ; B is now $BE after OUTI dec, but we reload it anyway
    ld   b, $FF             ; BC = $FFFD
    inc  a
    cp   14
    jr   nz, .loop
    ret
```

---

## Полная карта регистров

### Обзор

| Рег | Имя | Используемые биты | Чт/Зп | Сброс | Описание |
|-----|------|-----------|-----|-------|-------------|
| R0  | Период тона A, мл. | 7-0 | Чт/Зп | $00 | Период тона канала A, биты 7-0 |
| R1  | Период тона A, ст. | 3-0 | Чт/Зп | $00 | Период тона канала A, биты 11-8 |
| R2  | Период тона B, мл. | 7-0 | Чт/Зп | $00 | Период тона канала B, биты 7-0 |
| R3  | Период тона B, ст. | 3-0 | Чт/Зп | $00 | Период тона канала B, биты 11-8 |
| R4  | Период тона C, мл. | 7-0 | Чт/Зп | $00 | Период тона канала C, биты 7-0 |
| R5  | Период тона C, ст. | 3-0 | Чт/Зп | $00 | Период тона канала C, биты 11-8 |
| R6  | Период шума | 4-0 | Чт/Зп | $00 | Период генератора шума (0-31) |
| R7  | Микшер / I/O | 7-0 | Чт/Зп | $FF | Включение тона/шума + направление портов I/O |
| R8  | Громкость A | 4-0 | Чт/Зп | $00 | Громкость канала A или режим огибающей |
| R9  | Громкость B | 4-0 | Чт/Зп | $00 | Громкость канала B или режим огибающей |
| R10 | Громкость C | 4-0 | Чт/Зп | $00 | Громкость канала C или режим огибающей |
| R11 | Период огибающей, мл. | 7-0 | Чт/Зп | $00 | Период огибающей, биты 7-0 |
| R12 | Период огибающей, ст. | 7-0 | Чт/Зп | $00 | Период огибающей, биты 15-8 |
| R13 | Форма огибающей | 3-0 | Зп | -- | Форма волны огибающей (запись перезапускает огибающую) |
| R14 | Порт I/O A | 7-0 | Чт/Зп | -- | Универсальный I/O (прямое подключение на AY-3-8910) |
| R15 | Порт I/O B | 7-0 | Чт/Зп | -- | Универсальный I/O (прямое подключение на AY-3-8910) |

**Замечание по R14-R15:** AY-3-8910 имеет два 8-битных порта I/O. На ZX Spectrum 128K порт I/O A (R14) активен -- он читает матрицу клавиатуры и другие аппаратные сигналы. R15 (порт I/O B) обычно не подключён. AY-3-8912 (используемый в некоторых клонах) имеет только порт A; AY-3-8913 вообще не имеет портов I/O. Для программирования звука R14 и R15 не имеют значения.

---

### R0-R1: Период тона канала A (12 бит)

```
R0:  [D7] [D6] [D5] [D4] [D3] [D2] [D1] [D0]   bits 7-0 of period
R1:  [ 0] [ 0] [ 0] [ 0] [D11][D10][ D9][ D8]   bits 11-8 of period
```

- **Диапазон:** 1 до 4095 (12-битное беззнаковое). Период 0 ведёт себя как 1 на большинстве реализаций.
- **Действие:** Устанавливает частоту прямоугольной волны на канале A.
- **Формула:** `frequency = 1773400 / (16 * period)` (PAL Spectrum 128K)
- **Практический диапазон:** Период 1 = 110 837 Гц (ультразвук), период 4095 = 27 Гц (глубокий бас).

```z80
; Set channel A to middle C (C4, ~262 Hz, period 424)
    ld   a, 0              ; R0 = Tone A low
    ld   e, $A8            ; 424 & $FF = $A8
    call ay_write
    ld   a, 1              ; R1 = Tone A high
    ld   e, $01            ; 424 >> 8 = $01
    call ay_write
```

### R2-R3: Период тона канала B (12 бит)

Раскладка идентична R0-R1, для канала B.

### R4-R5: Период тона канала C (12 бит)

Раскладка идентична R0-R1, для канала C.

---

### R6: Период шума (5 бит)

```
R6:  [ 0] [ 0] [ 0] [D4] [D3] [D2] [D1] [D0]
```

- **Диапазон:** 0 до 31. Единственный генератор шума, общий для всех трёх каналов.
- **Действие:** Меньшие значения = более высокочастотный шум (шипение). Большие значения = более низкочастотный, грубый шум.
- **Формула:** `noise_frequency = 1773400 / (16 * period)` (та же, что для тона)

| Значение R6 | Характер | Типичное применение |
|----------|-----------|-------------|
| 0-5 | Высокое шипение | Хай-хэт, тарелка, металлический призвук |
| 6-12 | Средний шум | Тело малого барабана, белый шум |
| 13-20 | Низкий гул | Взрыв, двигатель, ветер |
| 21-31 | Очень низкий | Гром, далёкий гул |

Генератор шума использует 17-битный регистр сдвига с линейной обратной связью (LFSR) для генерации псевдослучайного выхода. Выход одинаков для AY-3-8910 и YM2149, но позиции отводов LFSR различаются, создавая чуть разные текстуры шума на каждом чипе.

---

### R7: Управление микшером (самый важный регистр)

```
R7:  [IOB] [IOA] [NC] [NB] [NA] [TC] [TB] [TA]
      bit7  bit6  bit5 bit4 bit3 bit2 bit1 bit0
```

| Бит | Имя | 0 = | 1 = |
|-----|------|-----|-----|
| 7 | Направление порта I/O B | Выход | **Вход** |
| 6 | Направление порта I/O A | Выход | **Вход** |
| 5 | Включение шума C | **ВКЛ** | Выкл |
| 4 | Включение шума B | **ВКЛ** | Выкл |
| 3 | Включение шума A | **ВКЛ** | Выкл |
| 2 | Включение тона C | **ВКЛ** | Выкл |
| 1 | Включение тона B | **ВКЛ** | Выкл |
| 0 | Включение тона A | **ВКЛ** | Выкл |

**Критически важно: 0 означает ВКЛ.** Микшер использует активно-низкую логику. Сброшенный бит включает соответствующий источник. Это самый запутывающий аспект программирования AY.

**Биты 7-6:** Всегда устанавливай в 1 (режим входа) на Spectrum. Не меняй их, если ты не знаешь, что делаешь с портами I/O.

#### Типичные значения микшера

| Значение | Двоичное (`NC NB NA TC TB TA`) | Эффект |
|-------|------------------------------|--------|
| `$38` | `%00 111 000` | Все три тона, без шума |
| `$3E` | `%00 111 110` | Только тон A |
| `$3D` | `%00 111 101` | Только тон B |
| `$3B` | `%00 111 011` | Только тон C |
| `$36` | `%00 110 110` | Тон A + Шум A |
| `$2D` | `%00 101 101` | Тон B + Шум B |
| `$1B` | `%00 011 011` | Тон C + Шум C |
| `$28` | `%00 101 000` | Все тона + Шум C (музыка + барабаны на C) |
| `$07` | `%00 000 111` | Весь шум, без тонов |
| `$00` | `%00 000 000` | Всё включено |
| `$3F` | `%00 111 111` | Всё выключено (тишина) |

**Примечание:** Двоичные значения выше показывают только биты 5-0. Биты 7-6 должны быть `%11` для нормальной работы (порты I/O как входы), что делает, например, `$38` реально `%11 111 000` = `$F8`. Однако на Spectrum 128K неиспользуемые старшие биты игнорируются по соглашению, и большинство кода использует короткую форму. Некоторые движки записывают полную форму `$F8`; оба варианта работают идентично.

```z80
; Enable tone A, tone B, tone C, and noise on C only
; Binary: I/O=11, NC=0(on), NB=1, NA=1, TC=0(on), TB=0(on), TA=0(on)
; = %11 011 000 = $D8 (full form) or $28 (short form, bits 7-6 treated as 0)
    ld   a, 7              ; R7 = Mixer
    ld   e, $28
    call ay_write
```

---

### R8-R10: Регистры громкости (5 бит)

```
R8:  [ 0] [ 0] [ 0] [ M] [D3] [D2] [D1] [D0]   Channel A
R9:  [ 0] [ 0] [ 0] [ M] [D3] [D2] [D1] [D0]   Channel B
R10: [ 0] [ 0] [ 0] [ M] [D3] [D2] [D1] [D0]   Channel C
```

| Бит | Функция |
|-----|----------|
| 4 (M) | Режим: 0 = фиксированная громкость (биты 3-0), 1 = использовать генератор огибающей |
| 3-0 | Уровень фиксированной громкости: 0 (тишина) до 15 (максимум) |

- **Режим фиксированной громкости** (бит 4 = 0): Биты 3-0 задают громкость канала напрямую. 15 = самый громкий, 0 = тишина. Кривая громкости логарифмическая на подлинном AY-3-8910 (приблизительно 1,5 дБ на шаг), но линейная на YM2149.
- **Режим огибающей** (бит 4 = 1): Громкость канала управляется генератором огибающей (R11-R13). Биты 3-0 игнорируются. Существует только один генератор огибающей, общий для всех каналов в режиме огибающей.

| Значение | Эффект |
|-------|--------|
| `$00` | Тишина |
| `$08` | Примерно половина громкости |
| `$0F` | Максимальная фиксированная громкость |
| `$10` | Режим огибающей (любое значение $10-$1F активирует огибающую) |

**Трюк с 4-битным ЦАП:** Быстро записывая последовательные значения сэмплов в регистр громкости (без режима огибающей), можно воспроизводить оцифрованный звук через AY. При частоте дискретизации 8 кГц это потребляет примерно 437 тактов (T-state) на запись сэмпла, не оставляя процессору почти ничего для другой работы. Подробнее о технике гибридных барабанов в главе 12.

```z80
; Set channel A to maximum fixed volume
    ld   a, 8              ; R8 = Volume A
    ld   e, $0F            ; volume 15
    call ay_write

; Switch channel C to envelope mode
    ld   a, 10             ; R10 = Volume C
    ld   e, $10            ; bit 4 set = envelope mode
    call ay_write
```

---

### R11-R12: Период огибающей (16 бит)

```
R11: [D7] [D6] [D5] [D4] [D3] [D2] [D1] [D0]   bits 7-0
R12: [D7] [D6] [D5] [D4] [D3] [D2] [D1] [D0]   bits 15-8
```

- **Диапазон:** 1 до 65535 (16-битное беззнаковое). Период 0 ведёт себя как 1.
- **Формула:** `envelope_frequency = 1773400 / (256 * period)`
- **При периоде = 1:** ~6 927 Гц (один полный цикл огибающей за ~144 микросекунды)
- **При периоде = 65535:** ~0,106 Гц (один цикл за ~9,4 секунды)

Период огибающей управляет скоростью нарастания или спада громкости в соответствии с формой, выбранной в R13. Для buzz-bass период огибающей заменяет период тона как управление высотой:

```
bass_envelope_period = 1773400 / (256 * desired_frequency)
```

Для баса C2 (65,4 Гц): период = 1773400 / (256 * 65,4) = 106.

```z80
; Set envelope period to 106 (bass C2 for buzz-bass)
    ld   a, 11             ; R11 = Envelope period low
    ld   e, 106            ; $6A
    call ay_write
    ld   a, 12             ; R12 = Envelope period high
    ld   e, 0
    call ay_write
```

---

### R13: Форма огибающей (4 бита, только запись)

```
R13: [ 0] [ 0] [ 0] [ 0] [CONT] [ATT] [ALT] [HOLD]
                            bit3   bit2  bit1   bit0
```

| Бит | Имя | Функция |
|-----|------|----------|
| 3 | CONT | Продолжение: 0 = однократная (сброс в 0 или удержание), 1 = повторяющаяся |
| 2 | ATT | Атака: 0 = начать с макс., спад вниз, 1 = начать с 0, нарастание вверх |
| 1 | ALT | Чередование: 0 = одно направление каждый цикл, 1 = реверс направления |
| 0 | HOLD | Удержание: 0 = нормальный цикл, 1 = удержание на финальном уровне после первого цикла |

**Критическое поведение:** Запись ЛЮБОГО значения в R13 немедленно перезапускает огибающую с начала цикла. Это верно, даже если ты записываешь то же значение, что уже хранится. Это поведение перезапуска критически важно для запуска нот buzz-bass и звуков ударных.

#### Все 16 значений формы

Хотя 4 бита позволяют 16 значений, многие дают идентичный результат. Уникальных форм всего 10:

| Значение | Биты (CONT ATT ALT HOLD) | Форма | Поведение |
|-------|---------------------------|-------|-----------|
| `$00` | `0 0 0 0` | `\___` | Спад до 0, удержание на 0 |
| `$01` | `0 0 0 1` | `\___` | То же, что $00 |
| `$02` | `0 0 1 0` | `\___` | То же, что $00 |
| `$03` | `0 0 1 1` | `\___` | То же, что $00 |
| `$04` | `0 1 0 0` | `/___` | Атака до 15, сброс до 0, удержание на 0 |
| `$05` | `0 1 0 1` | `/___` | То же, что $04 |
| `$06` | `0 1 1 0` | `/___` | То же, что $04 |
| `$07` | `0 1 1 1` | `/___` | То же, что $04 |
| `$08` | `1 0 0 0` | `\\\\` | Повторяющаяся пила вниз |
| `$09` | `1 0 0 1` | `\___` | Однократный спад, удержание на 0 (то же, что $00) |
| `$0A` | `1 0 1 0` | `\/\/` | Повторяющийся треугольник (вниз-вверх) |
| `$0B` | `1 0 1 1` | `\^^^` | Однократный спад, затем удержание на макс. (15) |
| `$0C` | `1 1 0 0` | `////` | Повторяющаяся пила вверх |
| `$0D` | `1 1 0 1` | `/^^^` | Однократная атака, затем удержание на макс. (15) |
| `$0E` | `1 1 1 0` | `/\/\` | Повторяющийся треугольник (вверх-вниз) |
| `$0F` | `1 1 1 1` | `/___` | Однократная атака, сброс до 0, удержание на 0 (то же, что $04) |

#### Формы волн огибающей

```
$00-$03, $09:              $04-$07, $0F:
 15 |\                      15    /|
    | \                          / |
    |  \                        /  |
    |   \                      /   |
  0 |    \___________        0 /    \___________


$08 (repeating \\\\):      $0C (repeating ////):
 15 |\  |\  |\  |\           15   /|  /|  /|  /|
    | \ | \ | \ | \              / | / | / | / |
    |  \|  \|  \|  \            /  |/  |/  |/  |
  0 |               |        0 |               |


$0A (repeating \/\/):      $0E (repeating /\/\):
 15 |\    /\    /\           15   /\    /\    /\
    | \  /  \  /  \              /  \  /  \  /  \
    |  \/    \/    \            /    \/    \/    \
  0 |               |        0 |               |


$0B (decay, hold max):     $0D (attack, hold max):
 15 |\                       15    /|
    | \  ___________              / |___________
    |  \/                        /  |
  0 |               |        0 |               |
```

#### Практические применения огибающей

| Форма | Значение | Сценарий использования |
|-------|-------|----------|
| `$00` | `\___` | Затухание барабана: резкий удар, затухающий до тишины |
| `$08` | `\\\\` | Buzz-bass: густой повторяющийся басовый тон |
| `$0C` | `////` | Buzz-bass (инвертированная фаза): та же высота, другой тембр |
| `$0A` | `\/\/` | Металлический/колокольный тон (треугольная модуляция) |
| `$0E` | `/\/\` | Металлический/колокольный тон (инвертированный треугольник) |
| `$0D` | `/^^^` | Нарастание: громкость поднимается до макс. и удерживается |

---

## Преобразование периода тона в частоту

### Формула

```
frequency = AY_clock / (16 * period)
period    = AY_clock / (16 * frequency)
```

### Тактовая частота AY по платформам

| Платформа | Частота AY | Частота CPU | Соотношение |
|----------|----------|-----------|-------------|
| ZX Spectrum 128K (PAL) | 1 773 400 Гц | 3 546 900 Гц | AY = CPU / 2 |
| ZX Spectrum 128K (NTSC) | 1 789 772 Гц | 3 579 545 Гц | AY = CPU / 2 |
| Pentagon 128 | 1 750 000 Гц | 3 500 000 Гц | AY = CPU / 2 |
| Amstrad CPC | 1 000 000 Гц | 4 000 000 Гц | AY = CPU / 4 |
| MSX | 1 789 772 Гц | 3 579 545 Гц | AY = CPU / 2 |
| Atari ST (YM2149) | 2 000 000 Гц | 8 000 000 Гц | YM = CPU / 4 |
| ZX Spectrum Next | 1 773 400 Гц | варьируется | То же, что 128K |

**Практическое следствие:** Одно и то же значение периода даёт чуть разную высоту на разных платформах. Мелодия, сочинённая на Pentagon (1,75 МГц), будет звучать чуть выше на Spectrum 128K (1,7734 МГц). Для большинства музыкальных целей разница неслышима.

### Полная таблица частот нот

Все значения периодов рассчитаны для тактовой частоты AY = 1 773 400 Гц (PAL Spectrum 128K).

Октавы 1-2 покрывают басовый диапазон (территория buzz-bass). Октавы 3-6 -- основной мелодический диапазон. Октавы 7-8 -- высокочастотные, с нарастающей неточностью из-за целочисленного округления.

#### Октава 1 (глубокий бас)

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-1  | 32,70 | 3390 | $3E | $0D |
| C#1  | 34,65 | 3199 | $7F | $0C |
| D-1  | 36,71 | 3019 | $CB | $0B |
| D#1  | 38,89 | 2850 | $22 | $0B |
| E-1  | 41,20 | 2690 | $82 | $0A |
| F-1  | 43,65 | 2539 | $EB | $09 |
| F#1  | 46,25 | 2396 | $5C | $09 |
| G-1  | 49,00 | 2262 | $D6 | $08 |
| G#1  | 51,91 | 2135 | $57 | $08 |
| A-1  | 55,00 | 2015 | $DF | $07 |
| A#1  | 58,27 | 1902 | $6E | $07 |
| B-1  | 61,74 | 1795 | $03 | $07 |

#### Октава 2 (бас)

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-2  | 65,41 | 1695 | $9F | $06 |
| C#2  | 69,30 | 1599 | $3F | $06 |
| D-2  | 73,42 | 1510 | $E6 | $05 |
| D#2  | 77,78 | 1425 | $91 | $05 |
| E-2  | 82,41 | 1345 | $41 | $05 |
| F-2  | 87,31 | 1270 | $F6 | $04 |
| F#2  | 92,50 | 1198 | $AE | $04 |
| G-2  | 98,00 | 1131 | $6B | $04 |
| G#2  | 103,83 | 1067 | $2B | $04 |
| A-2  | 110,00 | 1008 | $F0 | $03 |
| A#2  | 116,54 | 951  | $B7 | $03 |
| B-2  | 123,47 | 897  | $81 | $03 |

#### Октава 3

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-3  | 130,81 | 847 | $4F | $03 |
| C#3  | 138,59 | 800 | $20 | $03 |
| D-3  | 146,83 | 755 | $F3 | $02 |
| D#3  | 155,56 | 713 | $C9 | $02 |
| E-3  | 164,81 | 673 | $A1 | $02 |
| F-3  | 174,61 | 635 | $7B | $02 |
| F#3  | 185,00 | 599 | $57 | $02 |
| G-3  | 196,00 | 566 | $36 | $02 |
| G#3  | 207,65 | 534 | $16 | $02 |
| A-3  | 220,00 | 504 | $F8 | $01 |
| A#3  | 233,08 | 475 | $DB | $01 |
| B-3  | 246,94 | 449 | $C1 | $01 |

#### Октава 4 (средняя октава)

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-4  | 261,63 | 424 | $A8 | $01 |
| C#4  | 277,18 | 400 | $90 | $01 |
| D-4  | 293,66 | 378 | $7A | $01 |
| D#4  | 311,13 | 357 | $65 | $01 |
| E-4  | 329,63 | 337 | $51 | $01 |
| F-4  | 349,23 | 318 | $3E | $01 |
| F#4  | 369,99 | 300 | $2C | $01 |
| G-4  | 392,00 | 283 | $1B | $01 |
| G#4  | 415,30 | 267 | $0B | $01 |
| A-4  | 440,00 | 252 | $FC | $00 |
| A#4  | 466,16 | 238 | $EE | $00 |
| B-4  | 493,88 | 225 | $E1 | $00 |

#### Октава 5

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-5  | 523,25 | 212 | $D4 | $00 |
| C#5  | 554,37 | 200 | $C8 | $00 |
| D-5  | 587,33 | 189 | $BD | $00 |
| D#5  | 622,25 | 178 | $B2 | $00 |
| E-5  | 659,26 | 168 | $A8 | $00 |
| F-5  | 698,46 | 159 | $9F | $00 |
| F#5  | 739,99 | 150 | $96 | $00 |
| G-5  | 783,99 | 142 | $8E | $00 |
| G#5  | 830,61 | 134 | $86 | $00 |
| A-5  | 880,00 | 126 | $7E | $00 |
| A#5  | 932,33 | 119 | $77 | $00 |
| B-5  | 987,77 | 112 | $70 | $00 |

#### Октава 6

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-6  | 1046,50 | 106 | $6A | $00 |
| C#6  | 1108,73 | 100 | $64 | $00 |
| D-6  | 1174,66 | 94  | $5E | $00 |
| D#6  | 1244,51 | 89  | $59 | $00 |
| E-6  | 1318,51 | 84  | $54 | $00 |
| F-6  | 1396,91 | 79  | $4F | $00 |
| F#6  | 1479,98 | 75  | $4B | $00 |
| G-6  | 1567,98 | 71  | $47 | $00 |
| G#6  | 1661,22 | 67  | $43 | $00 |
| A-6  | 1760,00 | 63  | $3F | $00 |
| A#6  | 1864,66 | 59  | $3B | $00 |
| B-6  | 1975,53 | 56  | $38 | $00 |

#### Октава 7 (высокая)

| Нота | Частота (Гц) | Период | R_LO | R_HI |
|------|-----------|--------|------|------|
| C-7  | 2093,00 | 53 | $35 | $00 |
| C#7  | 2217,46 | 50 | $32 | $00 |
| D-7  | 2349,32 | 47 | $2F | $00 |
| D#7  | 2489,02 | 45 | $2D | $00 |
| E-7  | 2637,02 | 42 | $2A | $00 |
| F-7  | 2793,83 | 40 | $28 | $00 |
| F#7  | 2959,96 | 37 | $25 | $00 |
| G-7  | 3135,96 | 35 | $23 | $00 |
| G#7  | 3322,44 | 33 | $21 | $00 |
| A-7  | 3520,00 | 31 | $1F | $00 |
| A#7  | 3729,31 | 30 | $1E | $00 |
| B-7  | 3951,07 | 28 | $1C | $00 |

#### Октава 8 (очень высокая -- ограниченная точность)

| Нота | Частота (Гц) | Период | R_LO | R_HI | Реальная частота | Ошибка (центы) |
|------|-----------|--------|------|------|-------------|---------------|
| C-8  | 4186,01 | 26 | $1A | $00 | 4264,23 | +32 |
| C#8  | 4434,92 | 25 | $19 | $00 | 4433,50 | -1 |
| D-8  | 4698,63 | 24 | $18 | $00 | 4618,23 | -30 |
| D#8  | 4978,03 | 22 | $16 | $00 | 5038,07 | +21 |
| E-8  | 5274,04 | 21 | $15 | $00 | 5278,27 | +1 |
| F-8  | 5587,65 | 20 | $14 | $00 | 5541,88 | -14 |
| F#8  | 5919,91 | 19 | $13 | $00 | 5833,55 | -26 |
| G-8  | 6271,93 | 18 | $12 | $00 | 6158,75 | -32 |

**Примечание:** Выше октавы 6 целочисленное округление значения периода даёт всё более слышимые ошибки высоты. Столбцы «Реальная частота» и «Ошибка» для октавы 8 показывают реальную выходную частоту и отклонение в центах. Для высоких нот тонкая настройка невозможна -- разрешение просто слишком грубое.

### Компактная таблица нот для Z80-кода

Большинство движков трекеров хранят таблицу периодов как 16-битные слова. Вот практическая таблица на 96 нот (октавы 1-8) для включения в ассемблерный исходник:

```z80
; AY note period table: 96 notes, C-1 to B-8
; Each entry is a 16-bit period value (low byte first)
; Index = (octave * 12) + semitone, where C=0, C#=1, ..., B=11
note_table:
    ; Octave 1
    DW 3390, 3199, 3019, 2850, 2690, 2539
    DW 2396, 2262, 2135, 2015, 1902, 1795
    ; Octave 2
    DW 1695, 1599, 1510, 1425, 1345, 1270
    DW 1198, 1131, 1067, 1008,  951,  897
    ; Octave 3
    DW  847,  800,  755,  713,  673,  635
    DW  599,  566,  534,  504,  475,  449
    ; Octave 4
    DW  424,  400,  378,  357,  337,  318
    DW  300,  283,  267,  252,  238,  225
    ; Octave 5
    DW  212,  200,  189,  178,  168,  159
    DW  150,  142,  134,  126,  119,  112
    ; Octave 6
    DW  106,  100,   94,   89,   84,   79
    DW   75,   71,   67,   63,   59,   56
    ; Octave 7
    DW   53,   50,   47,   45,   42,   40
    DW   37,   35,   33,   31,   30,   28
    ; Octave 8
    DW   26,   25,   24,   22,   21,   20
    DW   19,   18,   17,   16,   15,   14
```

```z80
; Look up note period: A = note number (0-95)
; Returns DE = period value
; Clobbers: HL
get_note_period:
    ld   h, 0
    ld   l, a
    add  hl, hl           ; HL = note * 2 (word index)
    ld   de, note_table
    add  hl, de
    ld   e, (hl)
    inc  hl
    ld   d, (hl)          ; DE = period
    ret
```

### Таблица #5: Натуральный строй (чистая интонация)

Стандартная таблица нот выше использует равномерную темперацию (12-TET) -- каждый полутон -- это корень 12-й степени из 2. Это хорошо работает для тональных каналов, но создаёт проблему для **buzz-bass (T+E)**: поскольку `envelope_period = tone_period / 16`, любой период тона, не делящийся на 16, вносит ошибку округления. Огибающая дрейфует относительно тона, создавая слышимые биения на длинных басовых нотах.

«Частотная таблица с нулевой ошибкой» Ивана Рошина (2001) и реализация oisee для VTi (2009) решают это, используя **натуральный строй** -- целочисленные интервалы для до-мажора / ля-минора:

```
C [9/8] D [10/9] E [16/15] F [9/8] G [10/9] A [9/8] B [16/15] C
```

Это даёт чистые квинты (C--G, E--B, A--E в точном соотношении 3:2) и, что критически важно, периоды, где большинство нот основной гаммы делятся на 16 нацело.

**Тактовая частота AY: 1 520 640 Гц** (нестандартная; выбирай частоту для нужной тональности ниже):

```z80
; Table #5: Natural tuning note table
; 96 notes, C-1 to B-8, for AY clock = 1,520,640 Hz
; C major / A minor only; other keys via chip frequency change
natural_note_table:
    ; Octave 1
    DW 2880, 2700, 2560, 2400, 2304, 2160
    DW 2025, 1920, 1800, 1728, 1620, 1536
    ; Octave 2
    DW 1440, 1350, 1280, 1200, 1152, 1080
    DW 1013,  960,  900,  864,  810,  768
    ; Octave 3
    DW  720,  675,  640,  600,  576,  540
    DW  506,  480,  450,  432,  405,  384
    ; Octave 4
    DW  360,  338,  320,  300,  288,  270
    DW  253,  240,  225,  216,  203,  192
    ; Octave 5
    DW  180,  169,  160,  150,  144,  135
    DW  127,  120,  113,  108,  101,   96
    ; Octave 6
    DW   90,   84,   80,   75,   72,   68
    DW   63,   60,   56,   54,   51,   48
    ; Octave 7
    DW   45,   42,   40,   38,   36,   34
    DW   32,   30,   28,   27,   25,   24
    ; Octave 8
    DW   23,   21,   20,   19,   18,   17
    DW   16,   15,   14,   14,   13,   12
```

**Проверка делимости периодов (октава 2, басовый диапазон):**

| Нота | Период | mod 16 | Период огибающей | Чистый T+E? |
|------|--------|--------|------------|------------|
| C2   | 1440   | 0      | 90         | Да |
| C#2  | 1350   | 6      | 84         | Нет  |
| D2   | 1280   | 0      | 80         | Да |
| D#2  | 1200   | 0      | 75         | Да |
| E2   | 1152   | 0      | 72         | Да |
| F2   | 1080   | 0      | 67         | ~   |
| F#2  | 1013   | 5      | 63         | Нет  |
| G2   | 960    | 0      | 60         | Да |
| G#2  | 900    | 4      | 56         | Нет  |
| A2   | 864    | 0      | 54         | Да |
| A#2  | 810    | 2      | 50         | Нет  |
| B2   | 768    | 0      | 48         | Да |

Семь из двенадцати нот (все натуральные ноты до-мажора) делятся нацело -- по сравнению с *нулём* в равнотемперированной таблице.

**Транспозиция через частоту чипа:** поскольку таблица фиксирована для до/ля минор, другие тональности требуют другой тактовой частоты AY. Каждый шаг умножает на 2^(1/12):

| Тональность | Частота чипа (Гц) |
|-----|---------------------|
| C/Am    | 1 520 640 |
| C#/A#m  | 1 611 062 |
| D/Bm    | 1 706 861 |
| D#/Cm   | 1 808 356 |
| E/C#m   | 1 915 886 |
| F/Dm    | 2 029 811 |
| F#/D#m  | 2 150 510 |
| G/Em    | 2 278 386 |
| G#/Fm   | 2 413 866 |
| A/F#m   | 2 557 401 |
| A#/Gm   | 2 709 472 |
| B/G#m   | 2 870 586 |

На реальном железе тактовая частота AY фиксирована; в трекерах (Vortex Tracker II/Improved) и эмуляторах это настройка модуля. Таблица #5 -- стандарт для конвертера autosiril MIDI-to-PT3, потому что большинство конвертированных треков активно используют buzz-bass. Подробное объяснение проблемы выравнивания T+E в главе 11.

---

## TurboSound: 2 x AY

TurboSound -- аппаратная модификация, добавляющая второй чип AY, что даёт 6 тональных каналов, 2 генератора шума и 2 генератора огибающей. Наиболее распространённая современная реализация -- карта NedoPC TurboSound.

### Выбор чипа

Оба чипа AY делят одни и те же порты I/O ($FFFD/$BFFD). Значение выбора чипа, записанное в $FFFD, переключает все последующие операции с регистрами на выбранный чип.

| Значение выбора чипа | Цель |
|-------------------|--------|
| `$FF` | Чип 0 (основной / оригинальный AY) |
| `$FE` | Чип 1 (дополнительный AY) |

```z80
; Select chip 0 (primary)
    ld   bc, $FFFD
    ld   a, $FF
    out  (c), a          ; all subsequent R/W goes to chip 0

; Select chip 1 (secondary)
    ld   bc, $FFFD
    ld   a, $FE
    out  (c), a          ; all subsequent R/W goes to chip 1
```

**Важно:** Выбор чипа сохраняется до изменения. После выбора чипа 1 все операции с регистрами -- включая чтение -- направляются на чип 1. Всегда явно выбирай чип перед любым обращением к регистрам в своём движке.

### Архитектура движка TurboSound

Типичный музыкальный движок TurboSound поддерживает два 14-байтных буфера регистров и записывает их последовательно:

```z80
; Update both AY chips -- called once per frame from ISR
ts_update:
    ; --- Chip 0 ---
    ld   a, $FF
    ld   bc, $FFFD
    out  (c), a               ; select chip 0
    ld   hl, ay0_regs         ; 14-byte buffer for chip 0
    call ay_flush              ; write all 14 registers

    ; --- Chip 1 ---
    ld   a, $FE
    ld   bc, $FFFD
    out  (c), a               ; select chip 1
    ld   hl, ay1_regs         ; 14-byte buffer for chip 1
    call ay_flush              ; write all 14 registers
    ret

ay0_regs: DS 14               ; chip 0 register shadow
ay1_regs: DS 14               ; chip 1 register shadow
```

Общая стоимость: примерно 28 инструкций OUT, порядка 700-800 тактов (T-state) включая накладные расходы. Это около 1% бюджета кадра -- пренебрежимо мало.

### Стерео-конфигурация

TurboSound позволяет настоящее стерео. Два чипа можно жёстко панорамировать или смешивать:

| Конфигурация | Чип 0 (левый) | Чип 1 (правый) | Характер |
|---------------|---------------|-----------------|-----------|
| **Широкое стерео** | Лид, бас (A0+B0), барабаны (C0) | Контрмелодия (A1+B1), пэды (C1) | Просторное, концертное |
| **Центрированный бас** | Бас на C0 + C1 (те же данные) | Лид на A0, гармония на A1 | Плотный низ |
| **Раздельные барабаны** | Бочка (C0) | Малый + хай-хэт (C1) | Мощная, широкая перкуссия |

У каждого чипа свой независимый генератор шума и генератор огибающей. Это значит, что можно запустить buzz-bass на чипе 0 и совершенно независимую огибающую для перкуссии на чипе 1 без интерференции -- невозможно на одном AY.

---

## ZX Spectrum Next: Triple AY (3 x AY)

ZX Spectrum Next включает три AY-совместимых звуковых чипа, обеспечивая 9 тональных каналов, 3 генератора шума и 3 генератора огибающей.

### Выбор чипа на Next

Next расширяет протокол TurboSound. Третий чип выбирается тем же механизмом:

| Значение выбора чипа | Цель |
|-------------------|--------|
| `$FF` | Чип 0 |
| `$FE` | Чип 1 |
| `$FD` | Чип 2 |

Next также предоставляет доступ через Next-регистр $06 (Peripheral 2), настраивающий режим звукового чипа:

| Next Reg $06, биты 1-0 | Режим |
|-------------------------|------|
| `%00` | Одиночный AY (совместимость со Spectrum 128K) |
| `%01` | TurboSound (2 x AY) |
| `%10` | Triple AY (3 x AY) |

### Стерео-панорамирование каждого канала

Next добавляет функцию, которой у оригинального AY никогда не было: стерео-панорамирование для каждого канала. Каждый из 9 каналов может быть индивидуально панорамирован влево, вправо или в центр.

Панорамирование управляется через регистр AY 14 (R14), переназначенный на Next как регистр стерео-управления при обращении в контексте чипа AY:

| Бит | Канал | 0 = | 1 = |
|-----|---------|-----|-----|
| 0 | A, правый | выкл | вкл |
| 1 | A, левый | выкл | вкл |
| 2 | B, правый | выкл | вкл |
| 3 | B, левый | выкл | вкл |
| 4 | C, правый | выкл | вкл |
| 5 | C, левый | выкл | вкл |

Установи оба бита (левый + правый) для центрального панорамирования. Установи только один бит для жёсткого левого или правого.

---

## Типичные паттерны в Z80-коде

### Заглушить AY

```z80
; Silence all channels immediately
ay_silence:
    xor  a                 ; volume = 0
    ld   e, a
    ld   a, 8              ; R8 = Volume A
    call ay_write
    ld   a, 9              ; R9 = Volume B
    call ay_write
    ld   a, 10             ; R10 = Volume C
    call ay_write
    ; Disable all tone and noise
    ld   a, 7              ; R7 = Mixer
    ld   e, $3F            ; all off
    call ay_write
    ret
```

### Воспроизвести одну ноту на канале A

```z80
; Play note with period DE on channel A at volume 12
; Assumes mixer is already configured for tone A
play_note_a:
    ld   a, 0              ; R0 = Tone A low
    ld   e, d              ; wait -- let's do this properly
    ; Actually: DE has period, E = low byte, D = high byte
    push de
    ld   a, 0              ; R0
    call ay_write           ; E already has low byte
    pop  de
    ld   e, d
    ld   a, 1              ; R1
    call ay_write           ; E = high byte
    ld   a, 8              ; R8 = Volume A
    ld   e, 12             ; volume 12
    call ay_write
    ret
```

### Запустить ноту buzz-bass

```z80
; Buzz-bass: envelope-based bass note
; DE = envelope period for desired pitch
buzz_bass:
    ld   a, 11             ; R11 = Envelope period low
    call ay_write           ; E = low byte of period
    ld   e, d
    ld   a, 12             ; R12 = Envelope period high
    call ay_write
    ld   a, 13             ; R13 = Envelope shape
    ld   e, $08            ; repeating sawtooth down
    call ay_write           ; this also restarts the envelope
    ld   a, 10             ; R10 = Volume C
    ld   e, $10            ; envelope mode
    call ay_write
    ret
```

### Перезапуск огибающей

```z80
; Restart the envelope without changing its shape
; Useful for re-triggering buzz-bass on a new note
; The shape value must be written even if unchanged
env_restart:
    ld   a, 13             ; R13 = Envelope shape
    ld   e, (hl)           ; shape from current instrument data
    call ay_write           ; writing R13 = instant restart
    ret
```

### Удар цифрового барабана (4-битный ЦАП)

```z80
; Play a short digital sample through AY volume register
; HL = pointer to 4-bit sample data (values 0-15)
; B  = number of samples to play
; Uses channel A (R8) as DAC
;
; WARNING: This consumes all CPU time during playback.
; Disable interrupts before calling.
play_sample:
    di
    ld   a, 8              ; select R8 (Volume A)
    ld   bc, $FFFD
    out  (c), a
    ld   c, $FD            ; prepare for $BFFD writes
.loop:
    ld   a, (hl)           ; 7T   load sample
    inc  hl                ; 6T   advance pointer
    ld   b, $BF            ; 7T   BC = $BFFD
    out  (c), a            ; 12T  write volume = sample
    ; Timing padding: adjust NOPs to hit target sample rate
    nop                    ; 4T
    nop                    ; 4T
    ld   b, a              ; 4T   (dummy, preserves timing)
    ld   b, 0              ; 7T   reset B for next iteration
    ; Total per sample: ~51T = ~14.6 us = ~68.6 kHz
    ; For 8 kHz, add ~386T of padding (96 NOPs or a delay loop)
    dec  b
    jr   nz, .loop
    ei
    ret
```

Подробнее о технике гибридных барабанов (цифровая атака + затухание огибающей AY), делающей это практичным в движке демо, в главе 12.

---

## Замечания по форматам трекеров

### ProTracker 3 (.pt3)

**ProTracker 3** (PT3) -- наиболее широко используемый формат трекеров на ZX Spectrum 128K. Кросс-платформенный редактор **Vortex Tracker II** нативно создаёт файлы .pt3.

| Свойство | Значение |
|----------|-------|
| Каналы | 3 (одиночный AY) или 6 (TurboSound) |
| Длина паттерна | 1-64 строки |
| Скорость песни | 1-255 (кадров на строку) |
| Инструменты | Орнаментные таблицы + амплитудные огибающие |
| Эффекты | Арпеджио, портаменто, вибрато, управление огибающей |
| Размер проигрывателя | ~1,2-1,8 КБ (ассемблер Z80) |
| Формат данных | Упакованные паттерны + таблицы инструментов/орнаментов |

#### Как данные PT3 отображаются на регистры AY

На каждом кадре (1/50 секунды) проигрыватель PT3:

1. Декрементирует счётчик скорости. Если он достигает нуля, переходит к следующей строке.
2. Для каждого канала (A, B, C):
   - Читает ноту, инструмент и эффект из текущей строки.
   - Применяет орнамент инструмента (покадровая таблица смещений высоты тона).
   - Применяет амплитудную огибающую инструмента (покадровая таблица громкости).
   - Вычисляет итоговый период тона и громкость.
3. Обновляет регистр микшера (R7) на основе того, какие каналы используют тон, шум или оба.
4. Записывает все вычисленные значения в R0-R13.

```
PT3 row data:
  Note C-4, Instrument 3, Effect: Arpeggio +4+7
       |          |              |
       v          v              v
  Period=424  Ornament table  +4 semitones, +7 semitones
       |      applied per-frame  cycling every 3 frames
       v          |              |
  R0=$A8, R1=$01  |              |
       <----------+              |
  Final period adjusted by ornament offset
       <-----------------------------+
  Period cycles: 424 -> 337 -> 283 -> 424 -> ...
  (C4  -> E4  -> G4  -> C4  -> ...)
```

#### Интеграция в твой проект

```z80
; Standard PT3 integration
; 1. Include the player source
    INCLUDE "pt3player.asm"

; 2. Include the song data
song_data:
    INCBIN "mysong.pt3"

; 3. Initialise at startup
    ld   hl, song_data
    call music_init         ; PT3 player init routine

; 4. Call from IM2 handler every frame
isr_handler:
    ; ... push registers ...
    call music_play         ; PT3 player frame routine
    ; ... pop registers ...
    ei
    reti
```

### Другие форматы трекеров

| Формат | Трекер | Каналы | Размер проигрывателя | Ключевая особенность |
|--------|---------|----------|-------------|-------------|
| .pt3 | Pro Tracker 3 / Vortex Tracker II | 3-6 | ~1,2-1,8 КБ | Стандарт индустрии. Орнаменты + сэмплы. |
| .pt2 | Pro Tracker 2 | 3 | ~0,8-1,0 КБ | Старше, проще. Всё ещё используется из-за размера. |
| .stc | Sound Tracker / Sound Tracker Pro | 3 | ~0,5-0,7 КБ | Старейший формат Spectrum. Без орнаментов. |
| .asc | ASC Sound Master | 3 | ~0,8-1,0 КБ | Компактный проигрыватель. Фаворит российской сцены. |
| .sqt | SQ-Tracker | 3 | ~0,6-0,8 КБ | Отличное сжатие данных. |
| .ay  | AY emulation container | разное | N/A | Захватывает сырые дампы регистров. Для эмуляторов, не для движков воспроизведения. |

### Vortex Tracker II

**Vortex Tracker II** -- современный стандарт для сочинения музыки AY. Работает на Windows (и через Wine на Linux/macOS) и напрямую экспортирует файлы .pt3, совместимые со всеми стандартными Z80-проигрывателями.

Ключевые возможности для демосцены:
- **Режим TurboSound:** Редактирование 6 каналов (2 x AY) в одном модуле.
- **Редактор орнаментов:** Визуальные покадровые таблицы смещений высоты тона.
- **Редактор сэмплов:** Покадровое управление амплитудой + тоном/шумом.
- **Точки петли:** Установка начала петли для каждого паттерна и для всей песни.
- **Экспорт:** .pt3 (нативный), .txt (текстовый дамп для анализа), .wav (аудио-рендер).

Типичный рабочий процесс демосцены:
1. Сочиняй в Vortex Tracker II.
2. Экспортируй как .pt3.
3. Подключи стандартный `pt3player.asm` (широко доступен, множество версий, оптимизированных по размеру или скорости).
4. `INCBIN` данные .pt3.
5. Вызывай `music_init` и `music_play`, как показано выше.

---

## AY-3-8910 vs YM2149: различия, которые имеют значение

Yamaha YM2149 (используемый в Atari ST и некоторых клонах Spectrum) совместим по выводам с AY-3-8910, но не побитно идентичен:

| Особенность | AY-3-8910 | YM2149 |
|---------|-----------|--------|
| Кривая громкости | Логарифмическая (1,5 дБ/шаг) | Линейная |
| LFSR шума | 17-бит, специфические отводы | 17-бит, другие отводы |
| Точность огибающей | 16 уровней громкости (4-бит) | 32 уровня громкости (5-бит внутренне) |
| Вывод 26 (SEL) | Делитель тактовой частоты | То же, но часто зашит аппаратно |
| Выходной ЦАП | 4-битная резистивная лестница | 5-битная резистивная лестница |

**Практическое влияние:** Одна и та же мелодия звучит теплее/басовитее на настоящем AY-3-8910 и ярче/тоньше на YM2149 из-за различных кривых громкости. Эмуляторы обычно позволяют выбрать, какой чип эмулировать. При тестировании своей музыки попробуй оба -- у твоей аудитории может быть любой чип в машине.

---

## Краткая справочная карточка

### Сводка регистров (отрывная)

```
R0  = Tone A low        (8 bits)    R/W
R1  = Tone A high       (4 bits)    R/W
R2  = Tone B low        (8 bits)    R/W
R3  = Tone B high       (4 bits)    R/W
R4  = Tone C low        (8 bits)    R/W
R5  = Tone C high       (4 bits)    R/W
R6  = Noise period      (5 bits)    R/W    0=highest, 31=lowest
R7  = Mixer             (8 bits)    R/W    0=ON (active low!)
R8  = Volume A          (5 bits)    R/W    bit4=envelope mode
R9  = Volume B          (5 bits)    R/W    bit4=envelope mode
R10 = Volume C          (5 bits)    R/W    bit4=envelope mode
R11 = Envelope low      (8 bits)    R/W
R12 = Envelope high     (8 bits)    R/W
R13 = Envelope shape    (4 bits)    W      write = restart!

Ports:  $FFFD = select register    $BFFD = write data
Write:  OUT ($FFFD),reg  then  OUT ($BFFD),value
Read:   OUT ($FFFD),reg  then  IN A,($FFFD)

Tone:   freq = 1773400 / (16 * period)      period = 12-bit (1-4095)
Env:    freq = 1773400 / (256 * period)      period = 16-bit (1-65535)
Noise:  freq = 1773400 / (16 * period)       period = 5-bit (0-31)

Mixer R7 bits:  [IOB IOA | NC NB NA | TC TB TA]   0=enable, 1=disable
Envelope R13:   [CONT ATT ALT HOLD]
  $00 = \___    $08 = \\\\    $0A = \/\/    $0B = \^^^
  $04 = /___    $0C = ////    $0E = /\/\    $0D = /^^^

TurboSound:  $FF->$FFFD = chip 0    $FE->$FFFD = chip 1
Next 3xAY:   $FF = chip 0   $FE = chip 1   $FD = chip 2
```

---

> **Источники:** General Instrument AY-3-8910 / AY-3-8912 datasheet (1979); Yamaha YM2149 Application Manual; Dark "GS Sound System" (Spectrum Expert #01, 1997); Introspec "Eager" making-of (Hype 2015); Vortex Tracker II documentation (S.V. Bulba); NedoPC TurboSound FM documentation; ZX Spectrum Next User Manual, Issue 2
