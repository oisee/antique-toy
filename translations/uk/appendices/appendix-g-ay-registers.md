# Додаток G: Довідник регістрів AY-3-8910 / TurboSound / Triple AY

> *"Чотирнадцять регістрів. Три канали прямокутної хвилі. Один генератор шуму. Один генератор обвідної. Це все, що ти маєш."*
> -- Розділ 11

---

Цей додаток -- повний довідник на рівні регістрів для програмованого звукового генератора AY-3-8910, який використовується в ZX Spectrum 128K, клонах з TurboSound (Pentagon, Scorpion) та конфігурації triple-AY ZX Spectrum Next. Розділ 11 охоплює музичні техніки; цей додаток -- технічний опис, який ти тримаєш відкритим під час кодування.

Усі hex-значення використовують нотацію `$FF`. Двійкові значення використовують `%10101010`. Тактова частота передбачає стандарт PAL Spectrum 128K -- 1,7734 МГц, якщо не зазначено інше.

---

## Порти введення/виведення на ZX Spectrum 128K

| Порт | Напрямок | Функція |
|------|----------|---------|
| **$FFFD** | Запис | Вибір активного регістра (0-15) |
| **$FFFD** | Читання | Читання значення поточно вибраного регістра |
| **$BFFD** | Запис | Запис даних у вибраний регістр |

### Послідовність запису

Кожен запис регістра AY -- двокрокова операція: вибери регістр, потім запиши значення.

```z80
; Write value E to AY register A
; Clobbers: BC
ay_write:
    ld   bc, $FFFD
    out  (c), a       ; 12T  select register
    ld   b, $BF       ; 7T   BC = $BFFD (C stays $FD)
    out  (c), e       ; 12T  write data
    ret               ;      total: 31T + call overhead
```

Трюк: лише старший байт BC змінюється між двома інструкціями `OUT`. Молодший байт `$FD` залишається в C увесь час. Це заощаджує 3 байти та 10 тактів (T-state) порівняно з подвійним завантаженням повного 16-бітного значення.

### Читання регістра

```z80
; Read AY register A into A
; Clobbers: BC
ay_read:
    ld   bc, $FFFD
    out  (c), a       ; select register
    in   a, (c)       ; read value
    ret
```

Читання корисне для збереження стану мікшера (R7) при зміні ввімкнення окремих каналів.

### Пакетний запис регістрів

Для музичних рушіїв, що оновлюють усі 14 регістрів за кадр, розгорнутий цикл найшвидший:

```z80
; Write all 14 AY registers from a buffer
; HL = pointer to 14-byte register buffer (R0-R13)
ay_flush:
    ld   de, $BFFD         ; D = $BF, E = $FD
    ld   c, e              ; C = $FD (shared low byte)
    ld   b, $FF             ; BC = $FFFD (register select port)
    xor  a                  ; start at R0
.loop:
    out  (c), a             ; select register A
    ld   b, d               ; BC = $BFFD
    outi                    ; write (HL) to port, inc HL, dec B
    ; B is now $BE after OUTI dec, but we reload it anyway
    ld   b, $FF             ; BC = $FFFD
    inc  a
    cp   14
    jr   nz, .loop
    ret
```

---

## Повна карта регістрів

### Огляд

| Рег | Назва | Використані біти | R/W | Скидання | Опис |
|-----|-------|------------------|-----|----------|------|
| R0  | Період тону A, молодший | 7-0 | R/W | $00 | Період тону каналу A, біти 7-0 |
| R1  | Період тону A, старший | 3-0 | R/W | $00 | Період тону каналу A, біти 11-8 |
| R2  | Період тону B, молодший | 7-0 | R/W | $00 | Період тону каналу B, біти 7-0 |
| R3  | Період тону B, старший | 3-0 | R/W | $00 | Період тону каналу B, біти 11-8 |
| R4  | Період тону C, молодший | 7-0 | R/W | $00 | Період тону каналу C, біти 7-0 |
| R5  | Період тону C, старший | 3-0 | R/W | $00 | Період тону каналу C, біти 11-8 |
| R6  | Період шуму | 4-0 | R/W | $00 | Період генератора шуму (0-31) |
| R7  | Мікшер / I/O | 7-0 | R/W | $FF | Ввімкнення тону/шуму + напрямок порту I/O |
| R8  | Гучність A | 4-0 | R/W | $00 | Гучність каналу A або режим обвідної |
| R9  | Гучність B | 4-0 | R/W | $00 | Гучність каналу B або режим обвідної |
| R10 | Гучність C | 4-0 | R/W | $00 | Гучність каналу C або режим обвідної |
| R11 | Період обвідної, молодший | 7-0 | R/W | $00 | Період обвідної, біти 7-0 |
| R12 | Період обвідної, старший | 7-0 | R/W | $00 | Період обвідної, біти 15-8 |
| R13 | Форма обвідної | 3-0 | W | -- | Хвильова форма обвідної (запис перезапускає обвідну) |
| R14 | Порт I/O A | 7-0 | R/W | -- | Порт вводу/виводу загального призначення (безпосередньо на AY-3-8910) |
| R15 | Порт I/O B | 7-0 | R/W | -- | Порт вводу/виводу загального призначення (безпосередньо на AY-3-8910) |

**Примітка щодо R14-R15:** AY-3-8910 має два 8-бітних порти I/O. На ZX Spectrum 128K порт I/O A (R14) активний -- він зчитує матрицю клавіатури та інші апаратні сигнали. R15 (порт I/O B) зазвичай не підключений. AY-3-8912 (використовується в деяких клонах) має лише порт A; AY-3-8913 не має портів I/O взагалі. Для програмування звуку R14 та R15 не мають значення.

---

### R0-R1: Період тону каналу A (12-бітний)

```
R0:  [D7] [D6] [D5] [D4] [D3] [D2] [D1] [D0]   bits 7-0 of period
R1:  [ 0] [ 0] [ 0] [ 0] [D11][D10][ D9][ D8]   bits 11-8 of period
```

- **Діапазон:** від 1 до 4095 (12-бітне беззнакове). Період 0 поводиться як 1 у більшості реалізацій.
- **Ефект:** Встановлює частоту прямокутної хвилі на каналі A.
- **Формула:** `frequency = 1773400 / (16 * period)` (PAL Spectrum 128K)
- **Практичний діапазон:** Період 1 = 110 837 Гц (ультразвуковий), період 4095 = 27 Гц (глибокий бас).

```z80
; Set channel A to middle C (C4, ~262 Hz, period 424)
    ld   a, 0              ; R0 = Tone A low
    ld   e, $A8            ; 424 & $FF = $A8
    call ay_write
    ld   a, 1              ; R1 = Tone A high
    ld   e, $01            ; 424 >> 8 = $01
    call ay_write
```

### R2-R3: Період тону каналу B (12-бітний)

Ідентичний формат до R0-R1, для каналу B.

### R4-R5: Період тону каналу C (12-бітний)

Ідентичний формат до R0-R1, для каналу C.

---

### R6: Період шуму (5-бітний)

```
R6:  [ 0] [ 0] [ 0] [D4] [D3] [D2] [D1] [D0]
```

- **Діапазон:** від 0 до 31. Один генератор шуму, спільний для всіх трьох каналів.
- **Ефект:** Менші значення = вищий шум (шипіння). Більші значення = нижчий, грубіший шум.
- **Формула:** `noise_frequency = 1773400 / (16 * period)` (та сама формула, що й для тону)

| Значення R6 | Характер | Типове застосування |
|-------------|----------|---------------------|
| 0-5 | Високе шипіння | Хай-хет, тарілка, металевий дзвін |
| 6-12 | Середній шум | Тіло малого барабана, білий шум |
| 13-20 | Низький гуркіт | Вибух, двигун, вітер |
| 21-31 | Дуже низький | Грім, далекий гуркіт |

Генератор шуму використовує 17-бітний лінійний регістр зсуву зі зворотним зв'язком (LFSR) для генерації псевдовипадкового виходу. Вихід однаковий для AY-3-8910 та YM2149, але позиції відводів LFSR відрізняються, створюючи ледь помітно різні текстури шуму на кожному чіпі.

---

### R7: Керування мікшером (Найважливіший регістр)

```
R7:  [IOB] [IOA] [NC] [NB] [NA] [TC] [TB] [TA]
      bit7  bit6  bit5 bit4 bit3 bit2 bit1 bit0
```

| Біт | Назва | 0 = | 1 = |
|-----|-------|-----|-----|
| 7 | Напрямок порту I/O B | Вихід | **Вхід** |
| 6 | Напрямок порту I/O A | Вихід | **Вхід** |
| 5 | Ввімкнення шуму C | **УВІМК** | Вимк |
| 4 | Ввімкнення шуму B | **УВІМК** | Вимк |
| 3 | Ввімкнення шуму A | **УВІМК** | Вимк |
| 2 | Ввімкнення тону C | **УВІМК** | Вимк |
| 1 | Ввімкнення тону B | **УВІМК** | Вимк |
| 0 | Ввімкнення тону A | **УВІМК** | Вимк |

**Критично: 0 означає УВІМК.** Мікшер використовує активно-низьку логіку. Скинутий біт вмикає відповідне джерело. Це -- єдиний найбільш заплутаний аспект програмування AY.

**Біти 7-6:** Завжди встановлюй в 1 (режим входу) на Spectrum. Не змінюй їх, якщо не знаєш, що робиш з портами I/O.

#### Типові значення мікшера

| Значення | Двійковий (`NC NB NA TC TB TA`) | Ефект |
|----------|--------------------------------|-------|
| `$38` | `%00 111 000` | Всі три тони, без шуму |
| `$3E` | `%00 111 110` | Тільки тон A |
| `$3D` | `%00 111 101` | Тільки тон B |
| `$3B` | `%00 111 011` | Тільки тон C |
| `$36` | `%00 110 110` | Тон A + Шум A |
| `$2D` | `%00 101 101` | Тон B + Шум B |
| `$1B` | `%00 011 011` | Тон C + Шум C |
| `$28` | `%00 101 000` | Всі тони + Шум C (музика + барабани на C) |
| `$07` | `%00 000 111` | Весь шум, без тонів |
| `$00` | `%00 000 000` | Все увімкнено |
| `$3F` | `%00 111 111` | Все вимкнено (тиша) |

**Примітка:** Двійкові значення вище показують лише біти 5-0. Біти 7-6 мають бути `%11` для нормальної роботи (порти I/O як входи), що робить наприклад `$38` фактично `%11 111 000` = `$F8`. Однак на Spectrum 128K невикористані старші біти ігноруються за конвенцією, і більшість коду використовує коротку форму. Деякі рушії записують повну форму `$F8`; обидві працюють ідентично.

```z80
; Enable tone A, tone B, tone C, and noise on C only
; Binary: I/O=11, NC=0(on), NB=1, NA=1, TC=0(on), TB=0(on), TA=0(on)
; = %11 011 000 = $D8 (full form) or $28 (short form, bits 7-6 treated as 0)
    ld   a, 7              ; R7 = Mixer
    ld   e, $28
    call ay_write
```

---

### R8-R10: Регістри гучності (5-бітні)

```
R8:  [ 0] [ 0] [ 0] [ M] [D3] [D2] [D1] [D0]   Channel A
R9:  [ 0] [ 0] [ 0] [ M] [D3] [D2] [D1] [D0]   Channel B
R10: [ 0] [ 0] [ 0] [ M] [D3] [D2] [D1] [D0]   Channel C
```

| Біт | Функція |
|-----|---------|
| 4 (M) | Режим: 0 = використовувати фіксовану гучність (біти 3-0), 1 = використовувати генератор обвідної |
| 3-0 | Рівень фіксованої гучності: 0 (тиша) до 15 (максимум) |

- **Режим фіксованої гучності** (біт 4 = 0): Біти 3-0 встановлюють гучність каналу напряму. 15 = найгучніше, 0 = тиша. Крива гучності логарифмічна на справжньому AY-3-8910 (приблизно 1,5 дБ на крок), але лінійна на YM2149.
- **Режим обвідної** (біт 4 = 1): Гучність каналу контролюється генератором обвідної (R11-R13). Біти 3-0 ігноруються. Існує лише один генератор обвідної, спільний для всіх каналів у режимі обвідної.

| Значення | Ефект |
|----------|-------|
| `$00` | Тиша |
| `$08` | Приблизно половинна гучність |
| `$0F` | Максимальна фіксована гучність |
| `$10` | Режим обвідної (будь-яке значення $10-$1F активує обвідну) |

**Трюк 4-бітного ЦАП:** Швидко записуючи послідовні значення семплів у регістр гучності (без режиму обвідної), ти можеш відтворювати оцифрований звук через AY. При частоті дискретизації 8 кГц це споживає приблизно 437 тактів (T-state) на запис семплу, залишаючи майже нуль CPU для іншої роботи. Дивись Розділ 12 для техніки гібридних барабанів.

```z80
; Set channel A to maximum fixed volume
    ld   a, 8              ; R8 = Volume A
    ld   e, $0F            ; volume 15
    call ay_write

; Switch channel C to envelope mode
    ld   a, 10             ; R10 = Volume C
    ld   e, $10            ; bit 4 set = envelope mode
    call ay_write
```

---

### R11-R12: Період обвідної (16-бітний)

```
R11: [D7] [D6] [D5] [D4] [D3] [D2] [D1] [D0]   bits 7-0
R12: [D7] [D6] [D5] [D4] [D3] [D2] [D1] [D0]   bits 15-8
```

- **Діапазон:** від 1 до 65535 (16-бітне беззнакове). Період 0 поводиться як 1.
- **Формула:** `envelope_frequency = 1773400 / (256 * period)`
- **При періоді = 1:** ~6 927 Гц (один повний цикл обвідної за ~144 мікросекунди)
- **При періоді = 65535:** ~0,106 Гц (один цикл за ~9,4 секунди)

Період обвідної контролює, як швидко гучність наростає або спадає відповідно до форми, вибраної в R13. Для buzz-bass період обвідної замінює період тону як контроль висоти:

```
bass_envelope_period = 1773400 / (256 * desired_frequency)
```

Для басового C2 (65,4 Гц): період = 1773400 / (256 * 65,4) = 106.

```z80
; Set envelope period to 106 (bass C2 for buzz-bass)
    ld   a, 11             ; R11 = Envelope period low
    ld   e, 106            ; $6A
    call ay_write
    ld   a, 12             ; R12 = Envelope period high
    ld   e, 0
    call ay_write
```

---

### R13: Форма обвідної (4-бітний, тільки запис)

```
R13: [ 0] [ 0] [ 0] [ 0] [CONT] [ATT] [ALT] [HOLD]
                            bit3   bit2  bit1   bit0
```

| Біт | Назва | Функція |
|-----|-------|---------|
| 3 | CONT | Продовжити: 0 = одноразовий (скидання до 0 або утримання), 1 = повторення |
| 2 | ATT | Атака: 0 = починати з максимуму, спадати, 1 = починати з 0, наростати |
| 1 | ALT | Чергування: 0 = той самий напрямок кожен цикл, 1 = зворотній напрямок |
| 0 | HOLD | Утримання: 0 = циклювати нормально, 1 = утримувати на кінцевому рівні після першого циклу |

**Критична поведінка:** Запис БУДЬ-ЯКОГО значення в R13 негайно перезапускає обвідну з початку циклу. Це правда, навіть якщо ти записуєш те саме значення, яке вже збережено. Ця поведінка перезапуску є ключовою для запуску нот buzz-bass та звуків барабанів.

#### Усі 16 значень форми

Хоча 4 біти дозволяють 16 значень, багато з них дають ідентичний вихід. Існує лише 10 унікальних форм:

| Значення | Біти (CONT ATT ALT HOLD) | Форма | Поведінка |
|----------|--------------------------|-------|-----------|
| `$00` | `0 0 0 0` | `\___` | Спадання до 0, утримання на 0 |
| `$01` | `0 0 0 1` | `\___` | Те ж що $00 |
| `$02` | `0 0 1 0` | `\___` | Те ж що $00 |
| `$03` | `0 0 1 1` | `\___` | Те ж що $00 |
| `$04` | `0 1 0 0` | `/___` | Атака до 15, падіння до 0, утримання на 0 |
| `$05` | `0 1 0 1` | `/___` | Те ж що $04 |
| `$06` | `0 1 1 0` | `/___` | Те ж що $04 |
| `$07` | `0 1 1 1` | `/___` | Те ж що $04 |
| `$08` | `1 0 0 0` | `\\\\` | Повторювана пилкоподібна вниз |
| `$09` | `1 0 0 1` | `\___` | Одноразове спадання, утримання на 0 (те ж що $00) |
| `$0A` | `1 0 1 0` | `\/\/` | Повторюваний трикутник (вниз-вгору) |
| `$0B` | `1 0 1 1` | `\^^^` | Одноразове спадання, потім утримання на максимумі (15) |
| `$0C` | `1 1 0 0` | `////` | Повторювана пилкоподібна вгору |
| `$0D` | `1 1 0 1` | `/^^^` | Одноразова атака, потім утримання на максимумі (15) |
| `$0E` | `1 1 1 0` | `/\/\` | Повторюваний трикутник (вгору-вниз) |
| `$0F` | `1 1 1 1` | `/___` | Одноразова атака, падіння до 0, утримання на 0 (те ж що $04) |

#### Хвильові форми обвідної

```
$00-$03, $09:              $04-$07, $0F:
 15 |\                      15    /|
    | \                          / |
    |  \                        /  |
    |   \                      /   |
  0 |    \___________        0 /    \___________


$08 (repeating \\\\):      $0C (repeating ////):
 15 |\  |\  |\  |\           15   /|  /|  /|  /|
    | \ | \ | \ | \              / | / | / | / |
    |  \|  \|  \|  \            /  |/  |/  |/  |
  0 |               |        0 |               |


$0A (repeating \/\/):      $0E (repeating /\/\):
 15 |\    /\    /\           15   /\    /\    /\
    | \  /  \  /  \              /  \  /  \  /  \
    |  \/    \/    \            /    \/    \/    \
  0 |               |        0 |               |


$0B (decay, hold max):     $0D (attack, hold max):
 15 |\                       15    /|
    | \  ___________              / |___________
    |  \/                        /  |
  0 |               |        0 |               |
```

#### Практичне застосування обвідної

| Форма | Значення | Випадок використання |
|-------|----------|---------------------|
| `$00` | `\___` | Затухання барабана: різкий удар, що згасає в тишу |
| `$08` | `\\\\` | Buzz-bass: товстий повторюваний басовий тон |
| `$0C` | `////` | Buzz-bass (інвертована фаза): та сама висота, інший тембр |
| `$0A` | `\/\/` | Металевий/дзвоновий тон (трикутна модуляція) |
| `$0E` | `/\/\` | Металевий/дзвоновий тон (інвертований трикутник) |
| `$0D` | `/^^^` | Наростання: гучність зростає до максимуму та утримується |

---

## Перетворення періоду тону в частоту

### Формула

```
frequency = AY_clock / (16 * period)
period    = AY_clock / (16 * frequency)
```

### Тактова частота AY за платформами

| Платформа | Тактова частота AY | Тактова частота CPU | Зв'язок |
|-----------|-------------------|---------------------|---------|
| ZX Spectrum 128K (PAL) | 1 773 400 Гц | 3 546 900 Гц | AY = CPU / 2 |
| ZX Spectrum 128K (NTSC) | 1 789 772 Гц | 3 579 545 Гц | AY = CPU / 2 |
| Pentagon 128 | 1 750 000 Гц | 3 500 000 Гц | AY = CPU / 2 |
| Amstrad CPC | 1 000 000 Гц | 4 000 000 Гц | AY = CPU / 4 |
| MSX | 1 789 772 Гц | 3 579 545 Гц | AY = CPU / 2 |
| Atari ST (YM2149) | 2 000 000 Гц | 8 000 000 Гц | YM = CPU / 4 |
| ZX Spectrum Next | 1 773 400 Гц | різне | Як на 128K |

**Практичний наслідок:** Одне й те саме значення періоду дає трохи різну висоту на різних платформах. Мелодія, написана на Pentagon (1,75 МГц), звучатиме трохи вище на Spectrum 128K (1,7734 МГц). Для більшості музичних застосувань різниця нечутна.

### Повна таблиця частот нот

Усі значення періоду розраховані для тактової частоти AY = 1 773 400 Гц (PAL Spectrum 128K).

Октави 1-2 покривають басовий діапазон (територія buzz-bass). Октави 3-6 -- основний мелодичний діапазон. Октави 7-8 -- високі та дедалі неточніші через цілочисельне округлення.

#### Октава 1 (глибокий бас)

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-1  | 32.70 | 3390 | $3E | $0D |
| C#1  | 34.65 | 3199 | $7F | $0C |
| D-1  | 36.71 | 3019 | $CB | $0B |
| D#1  | 38.89 | 2850 | $22 | $0B |
| E-1  | 41.20 | 2690 | $82 | $0A |
| F-1  | 43.65 | 2539 | $EB | $09 |
| F#1  | 46.25 | 2396 | $5C | $09 |
| G-1  | 49.00 | 2262 | $D6 | $08 |
| G#1  | 51.91 | 2135 | $57 | $08 |
| A-1  | 55.00 | 2015 | $DF | $07 |
| A#1  | 58.27 | 1902 | $6E | $07 |
| B-1  | 61.74 | 1795 | $03 | $07 |

#### Октава 2 (бас)

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-2  | 65.41 | 1695 | $9F | $06 |
| C#2  | 69.30 | 1599 | $3F | $06 |
| D-2  | 73.42 | 1510 | $E6 | $05 |
| D#2  | 77.78 | 1425 | $91 | $05 |
| E-2  | 82.41 | 1345 | $41 | $05 |
| F-2  | 87.31 | 1270 | $F6 | $04 |
| F#2  | 92.50 | 1198 | $AE | $04 |
| G-2  | 98.00 | 1131 | $6B | $04 |
| G#2  | 103.83 | 1067 | $2B | $04 |
| A-2  | 110.00 | 1008 | $F0 | $03 |
| A#2  | 116.54 | 951  | $B7 | $03 |
| B-2  | 123.47 | 897  | $81 | $03 |

#### Октава 3

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-3  | 130.81 | 847 | $4F | $03 |
| C#3  | 138.59 | 800 | $20 | $03 |
| D-3  | 146.83 | 755 | $F3 | $02 |
| D#3  | 155.56 | 713 | $C9 | $02 |
| E-3  | 164.81 | 673 | $A1 | $02 |
| F-3  | 174.61 | 635 | $7B | $02 |
| F#3  | 185.00 | 599 | $57 | $02 |
| G-3  | 196.00 | 566 | $36 | $02 |
| G#3  | 207.65 | 534 | $16 | $02 |
| A-3  | 220.00 | 504 | $F8 | $01 |
| A#3  | 233.08 | 475 | $DB | $01 |
| B-3  | 246.94 | 449 | $C1 | $01 |

#### Октава 4 (середня октава)

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-4  | 261.63 | 424 | $A8 | $01 |
| C#4  | 277.18 | 400 | $90 | $01 |
| D-4  | 293.66 | 378 | $7A | $01 |
| D#4  | 311.13 | 357 | $65 | $01 |
| E-4  | 329.63 | 337 | $51 | $01 |
| F-4  | 349.23 | 318 | $3E | $01 |
| F#4  | 369.99 | 300 | $2C | $01 |
| G-4  | 392.00 | 283 | $1B | $01 |
| G#4  | 415.30 | 267 | $0B | $01 |
| A-4  | 440.00 | 252 | $FC | $00 |
| A#4  | 466.16 | 238 | $EE | $00 |
| B-4  | 493.88 | 225 | $E1 | $00 |

#### Октава 5

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-5  | 523.25 | 212 | $D4 | $00 |
| C#5  | 554.37 | 200 | $C8 | $00 |
| D-5  | 587.33 | 189 | $BD | $00 |
| D#5  | 622.25 | 178 | $B2 | $00 |
| E-5  | 659.26 | 168 | $A8 | $00 |
| F-5  | 698.46 | 159 | $9F | $00 |
| F#5  | 739.99 | 150 | $96 | $00 |
| G-5  | 783.99 | 142 | $8E | $00 |
| G#5  | 830.61 | 134 | $86 | $00 |
| A-5  | 880.00 | 126 | $7E | $00 |
| A#5  | 932.33 | 119 | $77 | $00 |
| B-5  | 987.77 | 112 | $70 | $00 |

#### Октава 6

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-6  | 1046.50 | 106 | $6A | $00 |
| C#6  | 1108.73 | 100 | $64 | $00 |
| D-6  | 1174.66 | 94  | $5E | $00 |
| D#6  | 1244.51 | 89  | $59 | $00 |
| E-6  | 1318.51 | 84  | $54 | $00 |
| F-6  | 1396.91 | 79  | $4F | $00 |
| F#6  | 1479.98 | 75  | $4B | $00 |
| G-6  | 1567.98 | 71  | $47 | $00 |
| G#6  | 1661.22 | 67  | $43 | $00 |
| A-6  | 1760.00 | 63  | $3F | $00 |
| A#6  | 1864.66 | 59  | $3B | $00 |
| B-6  | 1975.53 | 56  | $38 | $00 |

#### Октава 7 (висока)

| Нота | Частота (Гц) | Період | R_LO | R_HI |
|------|-------------|--------|------|------|
| C-7  | 2093.00 | 53 | $35 | $00 |
| C#7  | 2217.46 | 50 | $32 | $00 |
| D-7  | 2349.32 | 47 | $2F | $00 |
| D#7  | 2489.02 | 45 | $2D | $00 |
| E-7  | 2637.02 | 42 | $2A | $00 |
| F-7  | 2793.83 | 40 | $28 | $00 |
| F#7  | 2959.96 | 37 | $25 | $00 |
| G-7  | 3135.96 | 35 | $23 | $00 |
| G#7  | 3322.44 | 33 | $21 | $00 |
| A-7  | 3520.00 | 31 | $1F | $00 |
| A#7  | 3729.31 | 30 | $1E | $00 |
| B-7  | 3951.07 | 28 | $1C | $00 |

#### Октава 8 (дуже висока -- обмежена точність)

| Нота | Частота (Гц) | Період | R_LO | R_HI | Фактична частота | Похибка (центи) |
|------|-------------|--------|------|------|------------------|-----------------|
| C-8  | 4186.01 | 26 | $1A | $00 | 4264.23 | +32 |
| C#8  | 4434.92 | 25 | $19 | $00 | 4433.50 | -1 |
| D-8  | 4698.63 | 24 | $18 | $00 | 4618.23 | -30 |
| D#8  | 4978.03 | 22 | $16 | $00 | 5038.07 | +21 |
| E-8  | 5274.04 | 21 | $15 | $00 | 5278.27 | +1 |
| F-8  | 5587.65 | 20 | $14 | $00 | 5541.88 | -14 |
| F#8  | 5919.91 | 19 | $13 | $00 | 5833.55 | -26 |
| G-8  | 6271.93 | 18 | $12 | $00 | 6158.75 | -32 |

**Примітка:** Вище октави 6 цілочисельне округлення значення періоду створює дедалі помітніші похибки висоти. Стовпці "Фактична частота" та "Похибка" для октави 8 показують реальну вихідну частоту та відхилення в центах. Для високих нот точне налаштування неможливе -- роздільна здатність просто занадто груба.

### Компактна таблиця нот для Z80-коду

Більшість трекерних рушіїв зберігають таблицю періодів як 16-бітні слова. Ось практична 96-нотна таблиця (октави 1-8) для включення в вихідний код асемблера:

```z80
; AY note period table: 96 notes, C-1 to B-8
; Each entry is a 16-bit period value (low byte first)
; Index = (octave * 12) + semitone, where C=0, C#=1, ..., B=11
note_table:
    ; Octave 1
    DW 3390, 3199, 3019, 2850, 2690, 2539
    DW 2396, 2262, 2135, 2015, 1902, 1795
    ; Octave 2
    DW 1695, 1599, 1510, 1425, 1345, 1270
    DW 1198, 1131, 1067, 1008,  951,  897
    ; Octave 3
    DW  847,  800,  755,  713,  673,  635
    DW  599,  566,  534,  504,  475,  449
    ; Octave 4
    DW  424,  400,  378,  357,  337,  318
    DW  300,  283,  267,  252,  238,  225
    ; Octave 5
    DW  212,  200,  189,  178,  168,  159
    DW  150,  142,  134,  126,  119,  112
    ; Octave 6
    DW  106,  100,   94,   89,   84,   79
    DW   75,   71,   67,   63,   59,   56
    ; Octave 7
    DW   53,   50,   47,   45,   42,   40
    DW   37,   35,   33,   31,   30,   28
    ; Octave 8
    DW   26,   25,   24,   22,   21,   20
    DW   19,   18,   17,   16,   15,   14
```

```z80
; Look up note period: A = note number (0-95)
; Returns DE = period value
; Clobbers: HL
get_note_period:
    ld   h, 0
    ld   l, a
    add  hl, hl           ; HL = note * 2 (word index)
    ld   de, note_table
    add  hl, de
    ld   e, (hl)
    inc  hl
    ld   d, (hl)          ; DE = period
    ret
```

### Таблиця #5: Натуральний стрій (чиста інтонація)

Стандартна таблиця нот вище використовує рівномірну темперацію (12-TET) -- кожен півтон відстоїть на 12-й корінь з 2. Це добре працює для тональних каналів, але створює проблему для **buzz-bass (T+E)**: оскільки `envelope_period = tone_period / 16`, будь-який період тону, не кратний 16, вносить похибку округлення. Обвідна дрейфує відносно тону, створюючи чутні биття на тривалих басових нотах.

"Frequency Table with Zero Error" Івана Рошина (2001) та реалізація oisee для VTi (2009) вирішують це за допомогою **натурального строю** -- цілочисельних відношень інтервалів для до мажор / ля мінор:

```
C [9/8] D [10/9] E [16/15] F [9/8] G [10/9] A [9/8] B [16/15] C
```

Це дає чисті квінти (C--G, E--B, A--E при точному 3:2) і, що критично, періоди, де більшість нот основної гами діляться на 16 без залишку.

**Тактова частота AY: 1 520 640 Гц** (нестандартна; обирай частоту для конкретної тональності нижче):

```z80
; Table #5: Natural tuning note table
; 96 notes, C-1 to B-8, for AY clock = 1,520,640 Hz
; C major / A minor only; other keys via chip frequency change
natural_note_table:
    ; Octave 1
    DW 2880, 2700, 2560, 2400, 2304, 2160
    DW 2025, 1920, 1800, 1728, 1620, 1536
    ; Octave 2
    DW 1440, 1350, 1280, 1200, 1152, 1080
    DW 1013,  960,  900,  864,  810,  768
    ; Octave 3
    DW  720,  675,  640,  600,  576,  540
    DW  506,  480,  450,  432,  405,  384
    ; Octave 4
    DW  360,  338,  320,  300,  288,  270
    DW  253,  240,  225,  216,  203,  192
    ; Octave 5
    DW  180,  169,  160,  150,  144,  135
    DW  127,  120,  113,  108,  101,   96
    ; Octave 6
    DW   90,   84,   80,   75,   72,   68
    DW   63,   60,   56,   54,   51,   48
    ; Octave 7
    DW   45,   42,   40,   38,   36,   34
    DW   32,   30,   28,   27,   25,   24
    ; Octave 8
    DW   23,   21,   20,   19,   18,   17
    DW   16,   15,   14,   14,   13,   12
```

**Перевірка подільності періоду (Октава 2, басовий діапазон):**

| Нота | Період | mod 16 | Період обвідної | Чистий T+E? |
|------|--------|--------|-----------------|-------------|
| C2   | 1440   | 0      | 90         | Так |
| C#2  | 1350   | 6      | 84         | Ні  |
| D2   | 1280   | 0      | 80         | Так |
| D#2  | 1200   | 0      | 75         | Так |
| E2   | 1152   | 0      | 72         | Так |
| F2   | 1080   | 0      | 67         | ~   |
| F#2  | 1013   | 5      | 63         | Ні  |
| G2   | 960    | 0      | 60         | Так |
| G#2  | 900    | 4      | 56         | Ні  |
| A2   | 864    | 0      | 54         | Так |
| A#2  | 810    | 2      | 50         | Ні  |
| B2   | 768    | 0      | 48         | Так |

Сім з дванадцяти нот (усі натуральні ноти до мажор) діляться чисто -- порівняно з *нулем* у рівномірно темперованій таблиці.

**Транспозиція через частоту чіпа:** оскільки таблиця прив'язана до До/Лям, інші тональності потребують іншої тактової частоти AY. Кожен крок множиться на 2^(1/12):

| Тональність | Частота чіпа (Гц) |
|-------------|-------------------|
| C/Am    | 1 520 640 |
| C#/A#m  | 1 611 062 |
| D/Bm    | 1 706 861 |
| D#/Cm   | 1 808 356 |
| E/C#m   | 1 915 886 |
| F/Dm    | 2 029 811 |
| F#/D#m  | 2 150 510 |
| G/Em    | 2 278 386 |
| G#/Fm   | 2 413 866 |
| A/F#m   | 2 557 401 |
| A#/Gm   | 2 709 472 |
| B/G#m   | 2 870 586 |

На реальному обладнанні тактова частота AY фіксована; у трекерах (Vortex Tracker II/Improved) та емуляторах це налаштування для кожного модуля. Таблиця #5 є стандартною для конвертера autosiril MIDI-to-PT3, тому що більшість конвертованих треків активно використовують buzz-bass. Дивись Розділ 11 для детального пояснення проблеми вирівнювання T+E.

---

## TurboSound: 2 x AY

TurboSound -- це апаратна модифікація, що додає другий чіп AY, даючи 6 тональних каналів, 2 генератори шуму та 2 генератори обвідної. Найпоширеніша сучасна реалізація -- плата NedoPC TurboSound.

### Вибір чіпа

Обидва чіпи AY спільно використовують ті самі порти I/O ($FFFD/$BFFD). Значення вибору чіпа, записане в $FFFD, перемикає всі наступні операції з регістрами на вибраний чіп.

| Значення вибору чіпа | Ціль |
|----------------------|------|
| `$FF` | Чіп 0 (основний / оригінальний AY) |
| `$FE` | Чіп 1 (додатковий AY) |

```z80
; Select chip 0 (primary)
    ld   bc, $FFFD
    ld   a, $FF
    out  (c), a          ; all subsequent R/W goes to chip 0

; Select chip 1 (secondary)
    ld   bc, $FFFD
    ld   a, $FE
    out  (c), a          ; all subsequent R/W goes to chip 1
```

**Важливо:** Вибір чіпа зберігається до зміни. Після вибору чіпа 1 усі операції з регістрами -- включаючи читання -- спрямовуються на чіп 1. Завжди явно вибирай чіп перед будь-яким зверненням до регістрів у своєму рушії.

### Архітектура рушія TurboSound

Типовий музичний рушій TurboSound підтримує два 14-байтних буфери регістрів та записує їх послідовно:

```z80
; Update both AY chips -- called once per frame from ISR
ts_update:
    ; --- Chip 0 ---
    ld   a, $FF
    ld   bc, $FFFD
    out  (c), a               ; select chip 0
    ld   hl, ay0_regs         ; 14-byte buffer for chip 0
    call ay_flush              ; write all 14 registers

    ; --- Chip 1 ---
    ld   a, $FE
    ld   bc, $FFFD
    out  (c), a               ; select chip 1
    ld   hl, ay1_regs         ; 14-byte buffer for chip 1
    call ay_flush              ; write all 14 registers
    ret

ay0_regs: DS 14               ; chip 0 register shadow
ay1_regs: DS 14               ; chip 1 register shadow
```

Загальна вартість: приблизно 28 інструкцій OUT, приблизно 700-800 тактів (T-state) включаючи накладні витрати. Це близько 1% бюджету кадру -- знехтувано мало.

### Стерео-конфігурація

TurboSound забезпечує справжнє стерео. Два чіпи можуть бути розведені на ліво/право або змішані:

| Конфігурація | Чіп 0 (лівий) | Чіп 1 (правий) | Характер |
|--------------|---------------|----------------|----------|
| **Широке стерео** | Соло, бас (A0+B0), барабани (C0) | Контрмелодія (A1+B1), пади (C1) | Просторове, концертне |
| **Центрований бас** | Бас на C0 + C1 (ті самі дані) | Соло на A0, гармонія на A1 | Тверда основа |
| **Розділені барабани** | Бочка (C0) | Малий барабан + хай-хет (C1) | Потужна, широка перкусія |

Кожен чіп має свій власний незалежний генератор шуму та генератор обвідної. Це означає, що ти можеш запустити buzz-bass на чіпі 0 та повністю незалежну обвідну перкусію на чіпі 1 без інтерференції -- неможливо на одному AY.

---

## ZX Spectrum Next: Triple AY (3 x AY)

ZX Spectrum Next включає три AY-сумісних звукових чіпи, забезпечуючи 9 тональних каналів, 3 генератори шуму та 3 генератори обвідної.

### Вибір чіпа на Next

Next розширює протокол TurboSound. Третій чіп вибирається тим самим механізмом:

| Значення вибору чіпа | Ціль |
|----------------------|------|
| `$FF` | Чіп 0 |
| `$FE` | Чіп 1 |
| `$FD` | Чіп 2 |

Next також надає доступ через Next-регістр $06 (Peripheral 2), який конфігурує режим звукового чіпа:

| Next Reg $06, біти 1-0 | Режим |
|-------------------------|-------|
| `%00` | Одинарний AY (сумісний з Spectrum 128K) |
| `%01` | TurboSound (2 x AY) |
| `%10` | Triple AY (3 x AY) |

### Поканальне стерео-панорамування

Next додає функцію, якої оригінальний AY ніколи не мав: поканальне стерео-панорамування. Кожен з 9 каналів може бути індивідуально панорамований вліво, вправо або в центр.

Панорамування контролюється через регістр AY 14 (R14), перепризначений на Next як регістр стерео-контролю при зверненні в контексті AY-чіпа:

| Біт | Канал | 0 = | 1 = |
|-----|-------|-----|-----|
| 0 | A, правий | вимк | увімк |
| 1 | A, лівий | вимк | увімк |
| 2 | B, правий | вимк | увімк |
| 3 | B, лівий | вимк | увімк |
| 4 | C, правий | вимк | увімк |
| 5 | C, лівий | вимк | увімк |

Встанови обидва біти (лівий + правий) для центрального панорамування. Встанови лише один біт для жорсткого зсуву вліво або вправо.

---

## Типові патерни в Z80-коді

### Заглушити AY

```z80
; Silence all channels immediately
ay_silence:
    xor  a                 ; volume = 0
    ld   e, a
    ld   a, 8              ; R8 = Volume A
    call ay_write
    ld   a, 9              ; R9 = Volume B
    call ay_write
    ld   a, 10             ; R10 = Volume C
    call ay_write
    ; Disable all tone and noise
    ld   a, 7              ; R7 = Mixer
    ld   e, $3F            ; all off
    call ay_write
    ret
```

### Відтворити одну ноту на каналі A

```z80
; Play note with period DE on channel A at volume 12
; Assumes mixer is already configured for tone A
play_note_a:
    ld   a, 0              ; R0 = Tone A low
    ld   e, d              ; wait -- let's do this properly
    ; Actually: DE has period, E = low byte, D = high byte
    push de
    ld   a, 0              ; R0
    call ay_write           ; E already has low byte
    pop  de
    ld   e, d
    ld   a, 1              ; R1
    call ay_write           ; E = high byte
    ld   a, 8              ; R8 = Volume A
    ld   e, 12             ; volume 12
    call ay_write
    ret
```

### Запустити ноту buzz-bass

```z80
; Buzz-bass: envelope-based bass note
; DE = envelope period for desired pitch
buzz_bass:
    ld   a, 11             ; R11 = Envelope period low
    call ay_write           ; E = low byte of period
    ld   e, d
    ld   a, 12             ; R12 = Envelope period high
    call ay_write
    ld   a, 13             ; R13 = Envelope shape
    ld   e, $08            ; repeating sawtooth down
    call ay_write           ; this also restarts the envelope
    ld   a, 10             ; R10 = Volume C
    ld   e, $10            ; envelope mode
    call ay_write
    ret
```

### Перезапустити обвідну

```z80
; Restart the envelope without changing its shape
; Useful for re-triggering buzz-bass on a new note
; The shape value must be written even if unchanged
env_restart:
    ld   a, 13             ; R13 = Envelope shape
    ld   e, (hl)           ; shape from current instrument data
    call ay_write           ; writing R13 = instant restart
    ret
```

### Удар цифрового барабана (4-бітний ЦАП)

```z80
; Play a short digital sample through AY volume register
; HL = pointer to 4-bit sample data (values 0-15)
; B  = number of samples to play
; Uses channel A (R8) as DAC
;
; WARNING: This consumes all CPU time during playback.
; Disable interrupts before calling.
play_sample:
    di
    ld   a, 8              ; select R8 (Volume A)
    ld   bc, $FFFD
    out  (c), a
    ld   c, $FD            ; prepare for $BFFD writes
.loop:
    ld   a, (hl)           ; 7T   load sample
    inc  hl                ; 6T   advance pointer
    ld   b, $BF            ; 7T   BC = $BFFD
    out  (c), a            ; 12T  write volume = sample
    ; Timing padding: adjust NOPs to hit target sample rate
    nop                    ; 4T
    nop                    ; 4T
    ld   b, a              ; 4T   (dummy, preserves timing)
    ld   b, 0              ; 7T   reset B for next iteration
    ; Total per sample: ~51T = ~14.6 us = ~68.6 kHz
    ; For 8 kHz, add ~386T of padding (96 NOPs or a delay loop)
    dec  b
    jr   nz, .loop
    ei
    ret
```

Дивись Розділ 12 для техніки гібридних барабанів (цифрова атака + спадання обвідної AY), яка робить це практичним у рушії демо.

---

## Примітки щодо форматів трекерів

### ProTracker 3 (.pt3)

**ProTracker 3** (PT3) -- найпоширеніший формат трекера на ZX Spectrum 128K. Крос-платформний редактор **Vortex Tracker II** нативно створює файли .pt3.

| Властивість | Значення |
|------------|----------|
| Канали | 3 (одинарний AY) або 6 (TurboSound) |
| Довжина патерну | 1-64 рядки |
| Швидкість пісні | 1-255 (кадрів на рядок) |
| Інструменти | Таблиці орнаментів + амплітудні обвідні |
| Ефекти | Арпеджіо, портаменто, вібрато, керування обвідною |
| Розмір програвача | ~1,2-1,8 КБ (Z80-асемблер) |
| Формат даних | Упаковані патерни + таблиці інструментів/орнаментів |

#### Як дані PT3 відображаються на регістри AY

На кожному кадрі (1/50 секунди) програвач PT3:

1. Зменшує лічильник швидкості. Якщо він досягає нуля, переходить до наступного рядка.
2. Для кожного каналу (A, B, C):
   - Зчитує ноту, інструмент та ефект з поточного рядка.
   - Застосовує орнамент інструменту (таблицю покадрового зсуву висоти).
   - Застосовує амплітудну обвідну інструменту (покадрову таблицю гучності).
   - Обчислює остаточний період тону та гучність.
3. Оновлює регістр мікшера (R7) на основі того, які канали використовують тон, шум або обидва.
4. Записує всі обчислені значення в R0-R13.

```
PT3 row data:
  Note C-4, Instrument 3, Effect: Arpeggio +4+7
       |          |              |
       v          v              v
  Period=424  Ornament table  +4 semitones, +7 semitones
       |      applied per-frame  cycling every 3 frames
       v          |              |
  R0=$A8, R1=$01  |              |
       <----------+              |
  Final period adjusted by ornament offset
       <-----------------------------+
  Period cycles: 424 -> 337 -> 283 -> 424 -> ...
  (C4  -> E4  -> G4  -> C4  -> ...)
```

#### Інтеграція у твій проєкт

```z80
; Standard PT3 integration
; 1. Include the player source
    INCLUDE "pt3player.asm"

; 2. Include the song data
song_data:
    INCBIN "mysong.pt3"

; 3. Initialise at startup
    ld   hl, song_data
    call music_init         ; PT3 player init routine

; 4. Call from IM2 handler every frame
isr_handler:
    ; ... push registers ...
    call music_play         ; PT3 player frame routine
    ; ... pop registers ...
    ei
    reti
```

### Інші формати трекерів

| Формат | Трекер | Канали | Розмір програвача | Ключова особливість |
|--------|--------|--------|-------------------|---------------------|
| .pt3 | Pro Tracker 3 / Vortex Tracker II | 3-6 | ~1,2-1,8 КБ | Індустріальний стандарт. Орнаменти + семпли. |
| .pt2 | Pro Tracker 2 | 3 | ~0,8-1,0 КБ | Старіший, простіший. Все ще використовується через розмір. |
| .stc | Sound Tracker / Sound Tracker Pro | 3 | ~0,5-0,7 КБ | Найстаріший формат Spectrum. Без орнаментів. |
| .asc | ASC Sound Master | 3 | ~0,8-1,0 КБ | Компактний програвач. Улюбленець російської сцени. |
| .sqt | SQ-Tracker | 3 | ~0,6-0,8 КБ | Відмінне стиснення даних. |
| .ay  | Контейнер емуляції AY | різне | Н/З | Захоплює сирі дампи регістрів. Для емуляторів, не для рушіїв відтворення. |

### Vortex Tracker II

**Vortex Tracker II** -- сучасний стандарт для створення музики на AY. Працює на Windows (та через Wine на Linux/macOS) і безпосередньо експортує файли .pt3, сумісні з усіма стандартними програвачами Z80.

Ключові можливості для демосцени:
- **Режим TurboSound:** Редагування 6 каналів (2 x AY) в одному модулі.
- **Редактор орнаментів:** Візуальні покадрові таблиці зсуву висоти.
- **Редактор семплів:** Покадровий контроль амплітуди + тону/шуму.
- **Точки циклу:** Встановлення початку циклу для кожного патерну та для всієї пісні.
- **Експорт:** .pt3 (нативний), .txt (текстовий дамп для аналізу), .wav (аудіо-рендер).

Типовий робочий процес демосцени:
1. Створи музику в Vortex Tracker II.
2. Експортуй як .pt3.
3. Підключи стандартний `pt3player.asm` (широко доступний, кілька версій, оптимізованих за розміром або швидкістю).
4. `INCBIN` дані .pt3.
5. Виклич `music_init` та `music_play` як показано вище.

---

## AY-3-8910 проти YM2149: Відмінності, що мають значення

Yamaha YM2149 (використовується в Atari ST та деяких клонах Spectrum) є сумісною за виводами з AY-3-8910, але не бітово ідентичною:

| Характеристика | AY-3-8910 | YM2149 |
|----------------|-----------|--------|
| Крива гучності | Логарифмічна (1,5 дБ/крок) | Лінійна |
| LFSR шуму | 17-бітний, специфічні відводи | 17-бітний, інші відводи |
| Точність обвідної | 16 рівнів гучності (4-бітна) | 32 рівні гучності (внутрішньо 5-бітна) |
| Вивід 26 (SEL) | Дільник тактової частоти | Те саме, але часто жорстко зафіксований |
| Вихідний ЦАП | 4-бітна резисторна драбинка | 5-бітна резисторна драбинка |

**Практичний вплив:** Та сама мелодія звучить тепліше/басовіше на справжньому AY-3-8910 та яскравіше/тонше на YM2149 через різні криві гучності. Емулятори зазвичай дозволяють вибирати, який чіп емулювати. Тестуючи свою музику, спробуй обидва -- у твоєї аудиторії може бути будь-який чіп у їхній машині.

---

## Коротка довідкова картка

### Зведення регістрів (відривна)

```
R0  = Tone A low        (8 bits)    R/W
R1  = Tone A high       (4 bits)    R/W
R2  = Tone B low        (8 bits)    R/W
R3  = Tone B high       (4 bits)    R/W
R4  = Tone C low        (8 bits)    R/W
R5  = Tone C high       (4 bits)    R/W
R6  = Noise period      (5 bits)    R/W    0=highest, 31=lowest
R7  = Mixer             (8 bits)    R/W    0=ON (active low!)
R8  = Volume A          (5 bits)    R/W    bit4=envelope mode
R9  = Volume B          (5 bits)    R/W    bit4=envelope mode
R10 = Volume C          (5 bits)    R/W    bit4=envelope mode
R11 = Envelope low      (8 bits)    R/W
R12 = Envelope high     (8 bits)    R/W
R13 = Envelope shape    (4 bits)    W      write = restart!

Ports:  $FFFD = select register    $BFFD = write data
Write:  OUT ($FFFD),reg  then  OUT ($BFFD),value
Read:   OUT ($FFFD),reg  then  IN A,($FFFD)

Tone:   freq = 1773400 / (16 * period)      period = 12-bit (1-4095)
Env:    freq = 1773400 / (256 * period)      period = 16-bit (1-65535)
Noise:  freq = 1773400 / (16 * period)       period = 5-bit (0-31)

Mixer R7 bits:  [IOB IOA | NC NB NA | TC TB TA]   0=enable, 1=disable
Envelope R13:   [CONT ATT ALT HOLD]
  $00 = \___    $08 = \\\\    $0A = \/\/    $0B = \^^^
  $04 = /___    $0C = ////    $0E = /\/\    $0D = /^^^

TurboSound:  $FF->$FFFD = chip 0    $FE->$FFFD = chip 1
Next 3xAY:   $FF = chip 0   $FE = chip 1   $FD = chip 2
```

---

> **Джерела:** General Instrument AY-3-8910 / AY-3-8912 datasheet (1979); Yamaha YM2149 Application Manual; Dark "GS Sound System" (Spectrum Expert #01, 1997); Introspec "Eager" making-of (Hype 2015); Vortex Tracker II documentation (S.V. Bulba); NedoPC TurboSound FM documentation; ZX Spectrum Next User Manual, Issue 2
